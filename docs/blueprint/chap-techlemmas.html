<!DOCTYPE html>
<html lang="en">
<head>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<meta name="generator" content="plasTeX" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Technical Lemmas</title>
<link rel="next" href="chap-techprop.html" title="Deduction of main technical proposition" />
<link rel="prev" href="chap-fourier.html" title="Fourier Analysis" />
<link rel="up" href="index.html" title="Unit Fractions" />
<link rel="stylesheet" href="styles/theme-blue.css" />
<link rel="stylesheet" href="styles/amsthm.css" />
<link rel="stylesheet" href="styles/showmore.css" />
<link rel="stylesheet" href="styles/stylecours.css" />
</head>

<body>
<header>
<svg  id="toc-toggle" class="icon icon-list-numbered "><use xlink:href="symbol-defs.svg#icon-list-numbered"></use></svg>
<h1 id="doc_title"><a href="index.html">Unit Fractions</a></h1>
</header>

<div class="wrapper">
<nav class="toc">
<ul class="sub-toc-0">
<li class="">
  <a href="sect0001.html"><span class="toc_ref"></span> <span class="toc_entry">Introduction</span></a>
 </li>
<li class="">
  <a href="chap-def.html"><span class="toc_ref">1</span> <span class="toc_entry">Definitions</span></a>
 </li>
<li class="">
  <a href="chap-basic.html"><span class="toc_ref">2</span> <span class="toc_entry">Basic Estimates</span></a>
 </li>
<li class="">
  <a href="chap-tech.html"><span class="toc_ref">3</span> <span class="toc_entry">Deduction of the main results</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-1">
     <li class="">
  <a href="chap-tech.html#a0000000003"><span class="toc_ref">3.1</span> <span class="toc_entry">Sieve Lemmas</span></a>
 </li>

  </ul>
 </li>
<li class="">
  <a href="chap-fourier.html"><span class="toc_ref">4</span> <span class="toc_entry">Fourier Analysis</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-1">
     <li class="">
  <a href="chap-fourier.html#a0000000004"><span class="toc_ref">4.1</span> <span class="toc_entry">Local definitions</span></a>
 </li>
<li class="">
  <a href="chap-fourier.html#a0000000005"><span class="toc_ref">4.2</span> <span class="toc_entry">Precursor general lemmas</span></a>
 </li>
<li class="">
  <a href="chap-fourier.html#a0000000006"><span class="toc_ref">4.3</span> <span class="toc_entry">Towards the main proposition</span></a>
 </li>

  </ul>
 </li>
<li class=" active current">
  <a href="chap-techlemmas.html"><span class="toc_ref">5</span> <span class="toc_entry">Technical Lemmas</span></a>
 </li>
<li class="">
  <a href="chap-techprop.html"><span class="toc_ref">6</span> <span class="toc_entry">Deduction of main technical proposition</span></a>
 </li>
  <li></li>	
  <li>	
  <a href="dep_graph.html">Dependency graph</a>
  </li>
  <li>	
  <a href="https://b-mehta.github.io/unit-fractions/">Project home</a>
  </li>
</ul>
</nav>

<div class="content">
<div class="content-wrapper">


<div class="main-text">
<h1 id="chap:techlemmas">5 Technical Lemmas</h1>

<p><div class="lemma_thmwrapper" id="lem:basic">
  <div class="lemma_thmheading">
    <span class="lemma_thmcaption">
    Lemma
    </span>
    <span class="lemma_thmlabel">5.1</span>
    <div class="thm_icons">
    <a class="icon proof" href="chap-techlemmas.html#lem:basic">#</a>
    <a class="icon proof" href="chap-techlemmas.html#a0000000161"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/b-mehta/unit-fractions//blob/1b4ef039cfed0ebb250ff34bb8180d3296a2fbb3/src/main_results.lean#L47">rec_pp_sum_close</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="lemma_thmcontent">
  <p>  If \(0{\lt}\left\lvert n_1-n_2\right\rvert \leq N\) then </p>
<div class="displaymath" id="a0000000162">
  \[ \sum _{q\mid (n_1,n_2)}\frac{1}{q}\ll \log \log \log N, \]
</div>
<p> where the summation is restricted to prime powers. </p>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000161">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p> If \(q\mid (n_1,n_2)\) then \(q\) divides \(\left\lvert n_1-n_2\right\rvert \), and hence in particular \(q\leq N\). The contribution of all prime powers \(p^r\) with \(r\geq 2\) is \(O(1)\), and hence it suffices to show that \(\sum _{p\mid \left\lvert n_1-n_2\right\rvert }\frac{1}{p}\ll \log \log \log N\). Any integer \(\leq N\) is trivially divisible by \(O(\log N)\) many primes. Clearly summing \(1/p\) over \(O(\log N)\) many primes is maximised summing over the smallest \(O(\log N)\) primes. Since there are \(\gg (\log N)^{3/2}\) many primes \(\leq (\log N)^2\), we have </p>
<div class="displaymath" id="a0000000163">
  \[ \sum _{p\mid \left\lvert n_1-n_2\right\rvert }\frac{1}{p}\ll \sum _{p\leq (\log N)^2}\frac{1}{p}\ll \log \log \log N \]
</div>
<p> by Mertens’ estimate <a href="chap-basic.html#lem:mertens1">2.6</a>. </p>

  </div>
</div>
<p><div class="lemma_thmwrapper" id="lem:rtop">
  <div class="lemma_thmheading">
    <span class="lemma_thmcaption">
    Lemma
    </span>
    <span class="lemma_thmlabel">5.2</span>
    <div class="thm_icons">
    <a class="icon proof" href="chap-techlemmas.html#lem:rtop">#</a>
    <a class="icon proof" href="chap-techlemmas.html#a0000000164"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="chap-def.html#def:rec_sum_local">Definition 1.3</a></li>
          <li><a href="chap-def.html#def:rec_sum">Definition 1.1</a></li>
        </ul>

      </div>
    </div>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/b-mehta/unit-fractions//blob/1b4ef039cfed0ebb250ff34bb8180d3296a2fbb3/src/main_results.lean#L393">rec_qsum_lower_bound</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="lemma_thmcontent">
  <p>  Let \(1/2{\gt}\epsilon {\gt}0\) and \(N\) be sufficiently large, depending on \(\epsilon \). If \(A\) is a finite set of integers such that \(R(A)\geq (\log N)^{-\epsilon /2}\) and \((1-\epsilon )\log \log N\leq \omega (n)\leq 2\log \log N\) for all \(n\in A\) then </p>
<div class="displaymath" id="a0000000165">
  \[ \sum _{q\in \mathcal{Q}_A}\frac{1}{q} \geq (1-2\epsilon )e^{-1}\log \log N. \]
</div>


  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000164">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p>Since, by definition, every integer \(n\in A\) can be written uniquely as \(q_1\cdots q_t\) for \(q_i\in \mathcal{Q}_A\) for some \(t\in I = [(1-\epsilon )\log \log N, 2\log \log N]\), we have that, since \(t!\geq (t/e)^t\), </p>
<div class="displaymath" id="a0000000166">
  \[ R(A)\leq \sum _{t\in I}\frac{\left( \sum _{q\in \mathcal{Q}_A}\frac{1}{q}\right)^t}{t!}\leq \sum _{t\in I}\left( \frac{e}{t}\sum _{q\in \mathcal{Q}_A}\frac{1}{q}\right)^t. \]
</div>
<p> Since \((ex/t)^t\) is decreasing in \(t\) for \(x{\lt}t\), either \(\sum _{q\in \mathcal{Q}_A}\frac{1}{q}\geq (1-\epsilon )\log \log N\) (and we are done), or the summand is decreasing in \(t\), and hence we have </p>
<div class="displaymath" id="a0000000167">
  \[ (\log N)^{-\epsilon /2}\leq R(A)\leq 2\log \log N\left( \frac{\sum _{q\in \mathcal{Q}_A}\frac{1}{q}}{(1-\epsilon )e^{-1}\log \log N}\right)^{(1-\epsilon )\log \log N}. \]
</div>
<p> The claimed bound follows, using the fact that \(e^{-\frac{\epsilon }{2(1-\epsilon )}}\geq 1-\epsilon \) for \(\epsilon \in (0,1/2)\), choosing \(N\) large enough such that \((2\log \log N)^{2/\log \log N}\leq 1+\epsilon ^2\), say. </p>
<p>To verify the inequality \(e^{-\frac{\epsilon }{2(1-\epsilon )}}\geq 1-\epsilon \) for \(\epsilon \in (0,1/2)\), note that \(\frac{\epsilon }{2(1-\epsilon )}\leq \epsilon \) for all \(\epsilon \in (0,1/2)\), and hence using \(1+x\leq e^{x}\) for all \(x\geq -1\), we have </p>
<div class="displaymath" id="a0000000168">
  \[ e^{-\frac{\epsilon }{2(1-\epsilon )}}\geq e^{-\epsilon }\geq 1-\epsilon  \]
</div>
<p> as required. </p>

  </div>
</div>
<p><div class="lemma_thmwrapper" id="lem:smoothsum">
  <div class="lemma_thmheading">
    <span class="lemma_thmcaption">
    Lemma
    </span>
    <span class="lemma_thmlabel">5.3</span>
    <div class="thm_icons">
    <a class="icon proof" href="chap-techlemmas.html#lem:smoothsum">#</a>
    <a class="icon proof" href="chap-techlemmas.html#a0000000169"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/b-mehta/unit-fractions//blob/1b4ef039cfed0ebb250ff34bb8180d3296a2fbb3/src/main_results.lean#L41">useful_rec_bound</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="lemma_thmcontent">
  <p>  There is a constant \(C{\gt}0\) such that the following holds. Let \(0{\lt}y{\lt}N\) be some reals, and suppose that \(D\) is a finite set of integers such that if \(d\in D\) and \(p^r\|  d\) then \(y{\lt}p^r\leq N\). Then, for any real \(k\geq 1\), </p>
<div class="displaymath" id="a0000000170">
  \[ \sum _{d\in D}\frac{k^{\omega (d)}}{d}\leq \left(C\frac{\log N}{\log y}\right)^k. \]
</div>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000169">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p> We can write every \(d\in D\) uniquely as a product of prime powers \(d=p_1^{r_1}\cdots p_k^{r_k}\), where for each \(i\) either \(r_i=1\) and \(y{\lt}p_i\leq N\), or \(r_i\geq 2\) and \(p_i\leq N\). Therefore the left-hand side is at most </p>
<div class="displaymath" id="a0000000171">
  \[ \prod _{y{\lt}p\leq N}\left(1+\frac{k}{p}\right)\prod _{p\leq N}\left(1+\frac{k}{p^2}+\cdots \right). \]
</div>
<p> The second product is, using \(1+kx\leq (1+x)^k\), </p>
<div class="displaymath" id="a0000000172">
  \[ =\prod _{p\leq N}\left(1+\frac{k}{p(p-1)}\right)\leq \left(\prod _{p\leq N}\left(1+\frac{1}{p(p-1)}\right)\right)^k\leq C_1^k \]
</div>
<p> for some constant \(C_1{\gt}0\), since the product converges. Similarly, </p>
<div class="displaymath" id="a0000000173">
  \[ \prod _{y{\lt}p\leq N}\left(1+\frac{k}{p}\right)\leq \left(\prod _{y{\lt}p\leq N}\left(1+\frac{1}{p}\right)\right)^k, \]
</div>
<p> and the product here is \(\ll (\log N/\log y)\) by Mertens’ bound <a href="chap-basic.html#lem:mertens1">2.6</a>. Combining these yields the required estimate. </p>

  </div>
</div>
<p><div class="lemma_thmwrapper" id="lem:usingq">
  <div class="lemma_thmheading">
    <span class="lemma_thmcaption">
    Lemma
    </span>
    <span class="lemma_thmlabel">5.4</span>
    <div class="thm_icons">
    <a class="icon proof" href="chap-techlemmas.html#lem:usingq">#</a>
    <a class="icon proof" href="chap-techlemmas.html#a0000000174"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="chap-def.html#def:rec_sum_local">Definition 1.3</a></li>
        </ul>

      </div>
    </div>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/b-mehta/unit-fractions//blob/1b4ef039cfed0ebb250ff34bb8180d3296a2fbb3/src/main_results.lean#L55">find_good_d</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="lemma_thmcontent">
  <p>   There is a constant \(c{\gt}0\) such that the following holds. Let \(N\geq M\geq N^{1/2}\) be sufficiently large, and suppose that \(k\) is a real number such that \(1\leq k \leq c\log \log N\). Suppose that \(A\subset [M,N]\) is a set of integers such that \(\omega (n)\leq (\log N)^{1/k}\) for all \(n\in A\). </p>
<p>For all \(q\) such that \(R(A;q)\geq 1/\log N\) there exists \(d\) such that </p>
<ol class="enumerate">
  <li><p>\(qd {\gt} M\exp (-(\log N)^{1-1/k})\), </p>
</li>
  <li><p>\(\omega (d)\leq \tfrac {5}{\log k}\log \log N\), and </p>
</li>
  <li><div class="displaymath" id="a0000000175">
  \[ \sum _{\substack {n\in A_q\\ qd\mid n\\ (qd,n/qd)=1}}\frac{qd}{n}\gg \frac{R(A;q)}{(\log N)^{2/k}}. \]
</div>
</li>
</ol>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000174">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p> Fix some \(q\) with \(R(A;q)\geq (\log N)^{-1/2}\). Let \(y=\exp ((\log N)^{1-2/k})\). Let \(D\) be the set of all \(d\) such that if \(r\) is a prime power such that \(r\mid d\) and \((r,d/r)=1\) then \(y{\lt}r\leq N\), and furthermore </p>
<div class="displaymath" id="a0000000176">
  \[ qd\in (M\exp (-(\log N)^{1-1/k}),N]. \]
</div>
<p> We first claim that every \(n\in A_q\) is divisible by some \(qd\) with \(d\in D\), such that \((qd,n/qd)=1\). Let \(Q_n\) be the set of prime powers \(r\) dividing \(n\) such that \((r,n/r)=1\), so that \(n=\prod _{r\in Q_n}r\). Let </p>
<div class="displaymath" id="a0000000177">
  \[ Q_n'=\{  r\in Q_n: r\neq q\textrm{ and }r{\gt}y\} . \]
</div>
<p> We let \(d=\prod _{r\in Q_n'}r\). We need to check that \(d\in D\) and \(qd\mid n\). It is immediate from the definitions that if a prime power \(r\) divides \(d\) with \((r,d/r)=1\) then \(r\in Q_n'\), whence \(r{\gt}y\). It is also straightforward to check, by comparing prime powers, that \(qd\mid n\), and hence \(qd\leq n\leq N\). Furthermore, </p>
<div class="displaymath" id="a0000000178">
  \[ \frac{n}{qd}=\prod _{r\in Q_n\backslash Q_n'\cup \{ q\} }r\leq y^{\left\lvert Q_n\right\rvert }=y^{\omega (n)}\leq \exp ((\log N)^{1-1/k}), \]
</div>
<p> by definition of \(y\) and the hypothesis that \(\omega (n)\leq (\log N)^{1/k}\). It follows that \(d\in D\) as required. </p>
<p>If we let \(A_q(d)=\{  n \in A_q : qd\mid n\textrm{ and }(qd,n/qd)=1\} \) then we have shown that \(A_q\subseteq \bigcup _{d\in D}A_q(d)\). Therefore </p>
<div class="displaymath" id="a0000000179">
  \[ R(A;q) = \sum _{n\in A_q}\frac{q}{n}\leq \sum _{d\in D}\sum _{n\in A_q(d)}\frac{q}{n}. \]
</div>
<p>We will control the contribution from those \(d\) with \(\omega (d){\gt}\omega _0= \frac{5}{\log k}\log \log N\) with the trivial bound </p>
<div class="displaymath" id="a0000000180">
  \[ \sum _{A_q(d)}\frac{q}{n} \leq \sum _{\substack {n\leq N\\ qd\mid n}}\frac{q}{n}\leq \sum _{m\leq N}\frac{q}{dqm}\leq 2\frac{\log N}{d}, \]
</div>
<p> using the harmonic sum bound \(\sum _{m\leq N}\frac{1}{m}\leq \log N+1\leq 2\log N\). Therefore </p>
<div class="displaymath" id="a0000000181">
  \[  \sum _{\substack {d\in D\\ \omega (d){\gt}\omega _0}}\sum _{n\in A_q(d)}\frac{q}{n} \leq 2\log N\sum _{\substack {d\in D\\ \omega (d){\gt} \omega _0}} \frac{1}{d} \]
</div>
<div class="displaymath" id="a0000000182">
  \[ \leq 2k^{-\omega _0}\log N\sum _{d\in D} \frac{k^{\omega (d)}}{d}. \]
</div>
<p> By <a href="chap-techlemmas.html#lem:smoothsum">5.3</a> we have </p>
<div class="displaymath" id="a0000000183">
  \[ \sum _{d\in D}\frac{k^{\omega (d)}}{d}\leq \left(C\frac{\log N}{\log y}\right)^k. \]
</div>
<p> and therefore </p>
<div class="displaymath" id="a0000000184">
  \[ \sum _{\substack {d\in D\\ \omega (d){\gt}\omega _0}}\sum _{n\in A_q(d)}\frac{q}{n}\leq 2k^{-\omega _0}\log N \left(C\frac{\log N}{\log y}\right)^k. \]
</div>
<p> Recalling \(\omega _0=\frac{5}{\log k}\log \log N\) and \(y=\exp ((\log N)^{1-2/k})\) the right-hand side here is at most </p>
<div class="displaymath" id="a0000000185">
  \[ 2(\log N)^{-5}C^k\leq 1/2\log N\leq \tfrac {1}{2}R(A;q), \]
</div>
<p> for sufficiently large \(N\), assuming \(k\leq c\log \log N\) for sufficiently small \(c\). </p>
<p>It follows that </p>
<div class="displaymath" id="a0000000186">
  \[ \tfrac {1}{2}R(A;q)\leq \sum _{\substack {d\in D\\ \omega (d)\leq \omega _0}}\sum _{d\in D}\frac{q}{n} . \]
</div>
<p> The result follows by averaging, since by <a href="chap-techlemmas.html#lem:smoothsum">5.3</a> </p>
<div class="displaymath" id="a0000000187">
  \[ \sum _{d\in D}\frac{1}{d} \ll \frac{\log N}{\log y}\ll (\log N)^{2/k}. \]
</div>

  </div>
</div>
<p><div class="lemma_thmwrapper" id="lem:pisqa">
  <div class="lemma_thmheading">
    <span class="lemma_thmcaption">
    Lemma
    </span>
    <span class="lemma_thmlabel">5.5</span>
    ✓
    <div class="thm_icons">
    <a class="icon proof" href="chap-techlemmas.html#lem:pisqa">#</a>
    <a class="icon proof" href="chap-techlemmas.html#a0000000188"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="chap-def.html#def:rec_sum">Definition 1.1</a></li>
          <li><a href="chap-def.html#def:rec_sum_local">Definition 1.3</a></li>
        </ul>

      </div>
    </div>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/b-mehta/unit-fractions//blob/1b4ef039cfed0ebb250ff34bb8180d3296a2fbb3/src/main_results.lean#L509">pruning_lemma_one</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="lemma_thmcontent">
  <p>   Let \(N\) be sufficiently large, and let \(\epsilon {\gt}0\) and \(A\subset [1,N]\). There exists \(B\subset A\) such that </p>
<div class="displaymath" id="a0000000189">
  \[ R(B)\geq R(A)-2\epsilon \log \log N \]
</div>
<p> and \(\epsilon {\lt} R(B;q)\) for all \(q\in \mathcal{Q}_B\). </p>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000188">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p>We will prove the following claim, valid for any finite set \(A\subset \mathbb {N}\) with \(0\not\in A\) and \(\epsilon {\gt}0\), via induction: for all \(i\geq 0\) there exists \(A_i\subseteq A\) and \(Q_i\subseteq \mathcal{Q}_A\) such that </p>
<ol class="enumerate">
  <li><p>the sets \(\mathcal{Q}_{A_i}\) and \(Q_i\) are disjoint, </p>
</li>
  <li><p>\(R(A_i)\geq R(A)- \epsilon \sum _{q\in Q_i}\frac{1}{q}\), </p>
</li>
  <li><p>either \(i\leq \left\lvert A\backslash A_i\right\rvert \) or, for all \(q'\in \mathcal{Q}_{A_i}\), \(\epsilon {\lt} R(A_i;q')\). </p>
</li>
</ol>
<p>Given this claim, the stated lemma follows by choosing \(B=A_{\left\lvert A\right\rvert +1}\), noting that in the 5th point above the first alternative cannot hold, and furthermore </p>
<div class="displaymath" id="a0000000190">
  \[ \epsilon \sum _{q\in Q_{\left\lvert A\right\rvert +1}}\frac{1}{q}\leq \epsilon \sum _{q\leq N}\frac{1}{q}\leq 2\epsilon \log \log N, \]
</div>
<p> by Lemma&#160;<a href="chap-basic.html#lem:mertens1">2.6</a>, assuming \(N\) is sufficiently large. </p>
<p>To prove the inductive claim, we begin by choosing \(Q_0=\emptyset \), and \(A_0=A\). All of the properties are trivial to verify. </p>
<p>Suppose the proposition is true for \(i\geq 0\), with associated \(A_i,Q_i\). We will now prove it for \(i+1\). If it is true that, for all \(q'\in \mathcal{Q}_{A_i}\), we have \(\epsilon {\lt}R(A_i;q')\), then we let \(A_{i+1}=A_i\) and \(Q_{i+1}=Q_i\). </p>
<p>Otherwise, let \(q'\in \mathcal{Q}_{A_i}\) be such that \(R(A_i;q')\leq \epsilon \), set \(A_{i+1} = A_i\backslash \{  n\in A_i : q'\mid n \textrm{ and }(q',n/q')=1\} \), and \(Q_{i+1}=Q_i\cup \{ q'\} \). </p>
<p>It remains to verify the required properties. That \(Q_{i+1}\subseteq \mathcal{Q}_A\) follows from \(Q_i\subseteq \mathcal{Q}_A\) and \(q'\in \mathcal{Q}_{A_i}\subseteq \mathcal{Q}_A\) (using the general fact that if \(B\subseteq A\) then \(\mathcal{Q}_B\subseteq \mathcal{Q}_A\)). </p>
<p>For point (1), since \(A_{i+1}\subseteq A_i\), and hence \(\mathcal{Q}_{A_{i+1}}\subseteq \mathcal{Q}_{A_i}\), it suffices to show that \(q'\not\in \mathcal{Q}_{A_{i+1}}\). If this were not true, there would be some \(n\in A_{i+1}\) such that \(q'\mid n\) and \((q',n/q')=1\), contradiction to the definition of \(A_{i+1}\). </p>
<p>For point (2), we note that </p>
<div class="displaymath" id="a0000000191">
  \[ R(A_{i+1})= R(A_i)-\sum _{\substack {n\in A_i\\ q’\mid n\\ (q’,n/q’)=1}}\frac{1}{n} = R(A_i)-\frac{1}{q'}R(A_i;q')\geq R(A_i)-\epsilon \frac{1}{q'}, \]
</div>
<p> and point (2) follows from induction and the observation that </p>
<div class="displaymath" id="a0000000192">
  \[ \frac{1}{q'}+\sum _{q\in Q_i}\frac{1}{q}=\sum _{q\in Q_{i+1}}\frac{1}{q}, \]
</div>
<p> since \(q'\in \mathcal{Q}_{A_i}\) and hence \(q'\not\in Q_{i}\). </p>
<p>Finally, for point (3), we note that since we assume that it is not true that for all \(q'\in \mathcal{Q}_{A_i}\), we have \(\epsilon {\lt}R(A_i;q')\), it must be true that \(i\leq \left\lvert A\backslash A_{i}\right\rvert \). We now claim that \(i+1\leq \left\lvert A\backslash A_{i+1}\right\rvert \), for which it suffices to show that \(A_{i+1}\subsetneq A_i\). This is true since \(q'\in \mathcal{Q}_{A_i}\), and hence the set \(\{  n\in A_i : q'\mid n \textrm{ and }(q',n/q')=1\} \) is not empty. </p>

  </div>
</div>
<p><div class="lemma_thmwrapper" id="lem:pisq">
  <div class="lemma_thmheading">
    <span class="lemma_thmcaption">
    Lemma
    </span>
    <span class="lemma_thmlabel">5.6</span>
    ✓
    <div class="thm_icons">
    <a class="icon proof" href="chap-techlemmas.html#lem:pisq">#</a>
    <a class="icon proof" href="chap-techlemmas.html#a0000000193"><svg  class="icon icon-cogs "><use xlink:href="symbol-defs.svg#icon-cogs"></use></svg>
</a>
    <button class="modal lean">L∃∀N</button>
    <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
                <ul class="uses">
          <li><a href="https://github.com/b-mehta/unit-fractions//blob/1b4ef039cfed0ebb250ff34bb8180d3296a2fbb3/src/main_results.lean#L625">pruning_lemma_two</a></li>
        </ul>

      </div>
    </div>

  </div>
  </div>
  <div class="lemma_thmcontent">
  <p>  Suppose that \(N\) is sufficiently large and \(N{\gt}M\). Let \(\epsilon ,\alpha \) be reals such that \(\alpha {\gt} 4\epsilon \log \log N\) and \(A\subset [M,N]\) be a set of integers such that </p>
<div class="displaymath" id="a0000000194">
  \[ R(A) \geq \alpha +2\epsilon \log \log N \]
</div>
<p> and if \(q\in \mathcal{Q}_A\) then \(q\leq \epsilon M\). </p>
<p>There is a subset \(B\subset A\) such that \(R(B)\in [\alpha -1/M,\alpha )\) and, for all \(q\in \mathcal{Q}_B\), we have \(\epsilon {\lt} R(B;q)\). </p>

  </div>
</div> </p>
<div class="proof_wrapper" id="a0000000193">
  <div class="proof_heading">
    <span class="proof_caption">
    Proof
    </span>
    <span class="expand-proof">▼</span>
  </div>
  <div class="proof_content">
  <p> We will prove the following, for all \(N\) sufficiently large, real \(0{\lt}M{\lt}N\), reals \(\epsilon {\gt}0\) and \(\alpha {\gt} 4\epsilon \log \log N\) and finite sets \(A\subseteq [M,N]\) such that \(R(A)\geq \alpha \) and \(R(A;q){\gt} \epsilon \) for all \(q\in \mathcal{Q}_A\), by induction: for all \(i\geq 0\) there exists \(A_i\subseteq A\) such that </p>
<ol class="enumerate">
  <li><p>\(R(A_i)\geq \alpha -1/M\), </p>
</li>
  <li><p>\(R(A_i;q) {\gt} \epsilon \) for all \(q\in \mathcal{Q}_{A_i}\), and </p>
</li>
  <li><p>either \(i\leq \left\lvert A\backslash A_i\right\rvert \) or \(R(A_i){\lt}\alpha \). </p>
</li>
</ol>
<p>Given this claim, we prove the lemma as follows. Let \(A'\subseteq A\) be as given by Lemma&#160;<a href="chap-techlemmas.html#lem:pisqa">5.5</a>, so that the hypotheses of the inductive claim are satisfied for \(A'\). We now apply the inductive claim, and choose \(B=A_{\left\lvert A\right\rvert +1}\), noting that the first alternative of point (3) cannot hold. </p>
<p>It remains to prove the inductive claim. The base case \(i=0\) is immediate by hypotheses, choosing \(A_0=A\). </p>
<p>We now fix some \(i\geq 0\), with associated \(A_i\) as above, and prove the claim for \(i+1\). If \(R(A_i){\lt}\alpha \) then we set \(A_{i+1}=A_i\). Otherwise, we have \(R(A_i)\geq \alpha \). By Lemma&#160;<a href="chap-techlemmas.html#lem:pisqa">5.5</a> there exists \(B\subset A_i\) such that </p>
<div class="displaymath" id="a0000000195">
  \[ R(B)\geq R(A_i)-4\epsilon \log \log N\geq \alpha - 4\epsilon \log \log N{\gt}0 \]
</div>
<p> and \(2\epsilon {\lt} R(B;q)\) for all \(q\in \mathcal{Q}_B\). In particular, since \(R(B){\gt}0\), the set \(B\) is not empty. Let \(x\in B\) be arbitrary, and set \(A_{i+1}=A_i\backslash \{ x\} \). </p>
<p>We note that since \(x\in B\subseteq A\), we have \(x\geq M\), and hence \(R(A_{i+1})=R(A_i)-1/x\geq \alpha -1/M\), so point (1) is satisfied. Furthermore, since \(R(A_i)\geq \alpha \), we have \(i\leq \left\lvert A\backslash A_i\right\rvert \), and hence \(i+1 \leq \left\lvert A\backslash A_{i+1}\right\rvert \) and point (3) is satisfied. </p>
<p>For point (2), let \(q\in \mathcal{Q}_{A_{i+1}}\subseteq \mathcal{Q}_{A_i}\). If it is not true that \(q\mid x\) and \((q,x/q)=1\) then </p>
<div class="displaymath" id="a0000000196">
  \[ R(A_{i+1};q) = R(A_i; q){\gt}\epsilon . \]
</div>
<p> Otherwise, if \(q\mid x\) and \((q,x/q)=1\), then \(q\in \mathcal{Q}_B\). It follows that, since \(B\subseteq A_i\), we have </p>
<div class="displaymath" id="a0000000197">
  \[ R(A_{i+1};q)\geq R(B;q)-\frac{q}{x}{\gt}2\epsilon -\frac{q}{M}\geq \epsilon , \]
</div>
<p> since \(q\leq \epsilon M\). The inductive claim now follows. </p>

  </div>
</div>

</div> <!--main-text -->
</div> <!-- content-wrapper -->
</div> <!-- content -->
</div> <!-- wrapper -->

<nav class="prev_up_next">
  <svg  id="showmore-minus" class="icon icon-eye-minus showmore"><use xlink:href="symbol-defs.svg#icon-eye-minus"></use></svg>

  <svg  id="showmore-plus" class="icon icon-eye-plus showmore"><use xlink:href="symbol-defs.svg#icon-eye-plus"></use></svg>

  <a href="chap-fourier.html" title="Fourier Analysis"><svg  class="icon icon-arrow-left "><use xlink:href="symbol-defs.svg#icon-arrow-left"></use></svg>
</a>
  <a href="index.html" title="Unit Fractions"><svg  class="icon icon-arrow-up "><use xlink:href="symbol-defs.svg#icon-arrow-up"></use></svg>
</a>
  <a href="chap-techprop.html" title="Deduction of main technical proposition"><svg  class="icon icon-arrow-right "><use xlink:href="symbol-defs.svg#icon-arrow-right"></use></svg>
</a>
</nav>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/plastex.js"></script>
<script type="text/javascript" src="js/svgxuse.js"></script>
<script type="text/javascript" src="js/js.cookie.min.js"></script>
<script type="text/javascript" src="js/showmore.js"></script>
</body>
</html>